{{ define "posts" }}
    <ol class="posts" start="0">
        {{ template "posts-list" .Posts }}
    </ol>
    <a href="?after={{ .After }}">more</a>
{{ end }}
{{ define "posts-list" }}
    {{ range . }}
        <li>
            <p class="post-link"><a href="/post/{{ .Id }}">{{ .Title }}</a> {{ "some text here" }}</p>
        </li>
    {{ end }}
{{ end }}
{{ define "post" }}
    <div class="post" id="{{ .Id }}">
        <div class="post-content"><h1>{{ .Title }}</h1>{{ .Html }}</div>
        <p class="info">{{ .Username }}, {{ .Votes }} upvotes, {{ human_time .Time }}<br/>
        <a href="javascript:;" class="actions" onclick="toggle_summary(this);">summary</a>
        <a href="/post/{{ .Id }}" class="actions">link</a>
        <a href="javascript:;" class="actions" onclick="toggle_upvote(this);">upvote</a>
        <a href="javascript:;" class="actions" onclick="toggle_comment(this);">reply</a></p>
        {{ if .Comments }}
            <br/>
            <span class="line">// ----------------</span>
            <br/>
            {{ template "comment" .Comments }}
        {{ else }}
            <div class="comments">
                <p>no comments yet</p>
            </div>
        {{ end }}
    </div>
{{ end }}
{{ define "comment" }}
    {{ with . }}
        <div class="comments">
            {{ range . }}
                <br/>
                <div class="comment" id="{{ .Id }}">
                    <div class="comment-content">{{ .Html }}</div>
                    <p class="info">{{ .Username }}, {{ .Votes }} upvotes, {{ human_time .Time }}<br/>
                    <a href="javascript:;" class="actions" onclick="toggle_hidden(this);">hide</a>
                    <a href="#{{ .Id }}" class="actions">link</a>
                    <a href="javascript:;" class="actions" onclick="toggle_upvote(this);">upvote</a>
                    <a href="javascript:;" class="actions" onclick="toggle_comment(this);">reply</a></p>
                    {{ template "comment" .Comments }}
                </div>
            {{ end }}
        </div>
    {{ end }}
{{ end }}
{{ define "main" }}
    <!DOCTYPE html>
    <html>
        <head>
            <meta charset="utf-8">
            <title>{{ .Title }}</title>
            <link rel="stylesheet" type="text/css" href="/static/style.css"/>
            <script type="text/javascript" src="/static/script.js"></script>
        </head>
        <body>
            <header>
                <br/>
                <h1>
                    <a href="/">commune</a>
                </h1>
                <br/>
                <span class="line">// ----------------</span>
                <br/>
                <br/>
            </header>
            <nav>
                <br/>
                <h2>freshness</h2>
                <a href="javascript:;" onclick="set_freshness(0);">freshest</a>
                <a href="javascript:;" onclick="set_freshness(1);">fresher</a>
                <a href="javascript:;" onclick="set_freshness(2);">both</a>
                <a href="javascript:;" onclick="set_freshness(3);">higher</a>
                <a href="javascript:;" onclick="set_freshness(4);">highest</a>
                <br/><br/>

                <h2>search</h2>
                <form id="search" autocomplete="on" action="/" method="get">
                    <input name="search" type="search" required placeholder="#hashtag search query" title="">
                    <input type="submit" value="search">
                </form>
                <br/>

                <h2>submit post</h2>
                <form id="post" autocomplete="off" enctype="multipart/form-data" action="/submit_post" method="post">
                    <input type="text" name="title" required placeholder="title" title="">
                    <textarea name="text" rows="12" required placeholder="write the post text here" title=""></textarea>
                    <a href="https://github.com/paddygord/commune#commune">user guide</a>,
                    <a href="https://github.com/paddygord/commune#format">formatting</a>
                    <input type="submit" value="post">
                </form>
                <br/>

                <h2>about commune</h2>
                <p>commune is a community news and discussion site, with a radical focus on tolerance and inclusion,
                <a href="https://github.com/paddygord/commune#commune">user guide</a>,
                <a href="https://github.com/paddygord/commune">source</a></p>

                <form id="comment" autocomplete="off" enctype="multipart/form-data" action="/submit_comment" method="post">
                    <textarea name="text" rows="12" required placeholder="write the comment text here" title=""></textarea><br/>
                    <a href="https://github.com/paddygord/commune#commune">user guide</a>,
                    <a href="https://github.com/paddygord/commune#format">formatting</a>
                    <input type="submit" value="reply">
                    <input name="post_id" type="hidden" value="">
                    <input name="comment_id" type="hidden" value="">
                </form>

                <form id="upvote" autocomplete="off" enctype="multipart/form-data" action="/submit_upvote" method="post">
                    <input name="post_id" type="hidden" value="">
                    <input name="comment_id" type="hidden" value="">
                </form>
            </nav>
            <section>
                {{ .Content }}
            </section>
        </body>
    </html>
{{ end }}
